{"version":3,"file":"state-changes.js","sourceRoot":"","sources":["../../../../src/database/list/state-changes.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,OAAO,EAAE,MAAM,uBAAuB,CAAC;AAChD,OAAO,EAAE,mBAAmB,EAAE,MAAM,SAAS,CAAC;AAC9C,OAAO,EAAE,UAAU,EAAE,MAAM,iBAAiB,CAAC;AAC7C,OAAO,2BAA2B,CAAC;AACnC,OAAO,wBAAwB,CAAC;AAIhC,MAAM,6BAA6B,KAAoB,EAAE,UAA+B;IACtF,MAAM,CAAC,UAAC,MAAqB;QAAK,OAAA,UAAU,CAAC,SAAS,CAAC,sBAAsB,CAC3E,UAAU,CAAC,SAAS,CAAC,iBAAiB,CACpC,YAAY,CAAC,KAAK,EAAE,MAAM,CAAC,CAC5B,CACF;IAJiC,CAIjC,CAAC;CACH;AAED,MAAM,uBAAuB,KAAoB,EAAE,MAAqB;IACtE,MAAM,IAAG,mBAAmB,CAAC,MAAM,CAAE,CAAA,CAAC;IACtC,IAAM,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,EAArB,CAAqB,CAAC,CAAC;IAC/D,MAAM,CAAC,UAAU,CAAC,KAAK,OAAhB,UAAU,EAAU,WAAW,EAAE;CACzC","sourcesContent":["import { DatabaseQuery, ChildEvent, AngularFireAction, SnapshotAction } from '../interfaces';\r\nimport { fromRef } from '../observable/fromRef';\r\nimport { validateEventsArray } from './utils';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/observable/merge';\r\nimport 'rxjs/add/operator/scan';\r\nimport { DataSnapshot } from '@firebase/database-types';\r\nimport { AngularFireDatabase } from '../database';\r\n\r\nexport function createStateChanges(query: DatabaseQuery, afDatabase: AngularFireDatabase) {\r\n  return (events?: ChildEvent[]) => afDatabase.scheduler.keepUnstableUntilFirst(\r\n    afDatabase.scheduler.runOutsideAngular(\r\n      stateChanges(query, events)\r\n    )\r\n  );\r\n}\r\n\r\nexport function stateChanges(query: DatabaseQuery, events?: ChildEvent[]) {\r\n  events = validateEventsArray(events)!;\r\n  const childEvent$ = events.map(event => fromRef(query, event));\r\n  return Observable.merge(...childEvent$);\r\n}\r\n"]}