{"version":3,"file":"create-reference.js","sourceRoot":"","sources":["../../../../src/database/object/create-reference.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,2BAA2B,EAAE,MAAM,oBAAoB,CAAC;AAGjE,MAAM,gCAAmC,KAAoB,EAAE,UAA+B;IAC5F,MAAM,CAAC;QACL,KAAK,OAAA;QACL,eAAe,EAAf;YACE,IAAM,gBAAgB,GAAG,2BAA2B,CAAC,KAAK,CAAC,EAAE,CAAC;YAC9D,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,sBAAsB,CAChD,UAAU,CAAC,SAAS,CAAC,iBAAiB,CACpC,gBAAgB,CACjB,CACF,CAAC;SACH;QACD,MAAM,YAAC,IAAgB,IAAI,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,IAAW,CAAkB,CAAC,EAAE;QACnF,GAAG,YAAC,IAAO,IAAI,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAkB,CAAC,EAAE;QAC7D,MAAM,gBAAK,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,EAAmB,CAAC,EAAE;QACxD,YAAY,EAAZ;YACE,IAAM,gBAAgB,GAAG,2BAA2B,CAAC,KAAK,CAAC,EAAE,CAAC;YAC9D,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,sBAAsB,CAChD,UAAU,CAAC,SAAS,CAAC,iBAAiB,CACpC,gBAAgB,CACjB,CACF,CAAC,GAAG,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,EAAO,GAAG,IAAI,EAA1D,CAA0D,CAAC,CAAA;SAC5E;KACF,CAAA;CACF","sourcesContent":["import { DatabaseQuery, AngularFireObject } from '../interfaces';\r\nimport { createObjectSnapshotChanges } from './snapshot-changes';\r\nimport { AngularFireDatabase } from '../database';\r\n\r\nexport function createObjectReference<T>(query: DatabaseQuery, afDatabase: AngularFireDatabase): AngularFireObject<T> {\r\n  return {\r\n    query,\r\n    snapshotChanges<T>() {\r\n      const snapshotChanges$ = createObjectSnapshotChanges(query)();\r\n      return afDatabase.scheduler.keepUnstableUntilFirst(\r\n        afDatabase.scheduler.runOutsideAngular(\r\n          snapshotChanges$\r\n        )\r\n      );\r\n    },\r\n    update(data: Partial<T>) { return query.ref.update(data as any) as Promise<void>; },\r\n    set(data: T) { return query.ref.set(data) as Promise<void>; },\r\n    remove() { return query.ref.remove() as Promise<void>; },\r\n    valueChanges<T>() { \r\n      const snapshotChanges$ = createObjectSnapshotChanges(query)();\r\n      return afDatabase.scheduler.keepUnstableUntilFirst(\r\n        afDatabase.scheduler.runOutsideAngular(\r\n          snapshotChanges$\r\n        )\r\n      ).map(action => action.payload.exists() ? action.payload.val() as T : null)\r\n    },\r\n  }\r\n}\r\n"]}