{"version":3,"file":"firebase_list_factory.spec.js","sourceRoot":"","sources":["../../../src/database-deprecated/firebase_list_factory.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { DataSnapshot } from '@firebase/database-types';\r\nimport { FirebaseApp, FirebaseAppConfig, AngularFireModule} from 'angularfire2';\r\nimport { AngularFireDatabase, AngularFireDatabaseModule, FirebaseListObservable,\r\n  FirebaseListFactory, onChildAdded, onChildChanged, onChildRemoved, onChildUpdated,\r\n  FirebaseObjectFactory\r\n} from 'angularfire2/database-deprecated';\r\nimport { TestBed, inject } from '@angular/core/testing';\r\nimport * as utils from './utils';\r\nimport { Query, AFUnwrappedDataSnapshot } from './interfaces';\r\nimport { Subscription, Observable, Subject } from 'rxjs';\r\nimport { COMMON_CONFIG } from './test-config';\r\nimport { _do } from 'rxjs/operator/do';\r\nimport { map } from 'rxjs/operator/map';\r\nimport { skip } from 'rxjs/operator/skip';\r\nimport { take } from 'rxjs/operator/take';\r\nimport { toArray } from 'rxjs/operator/toArray';\r\nimport { toPromise } from 'rxjs/operator/toPromise';\r\n\r\nconst questionsPath = 'questions';\r\n\r\nfunction queryTest(observable: Observable<any>, subject: Subject<any>, done: any) {\r\n  let nexted = false;\r\n  skipAndTake(observable, 2)\r\n    .subscribe((val: any) => {\r\n      if (!nexted) {\r\n        subject.next('2');\r\n      }\r\n      if (nexted) {\r\n        expect(nexted).toBe(true);\r\n        done();\r\n      }\r\n      nexted = true;\r\n    });\r\n\r\n  subject.next('20');\r\n}\r\n\r\ndescribe('AngularFireDatabase', () => {\r\n  let app: FirebaseApp;\r\n  let db: AngularFireDatabase;\r\n\r\n  beforeEach(() => {\r\n    TestBed.configureTestingModule({\r\n      imports: [\r\n        AngularFireModule.initializeApp(COMMON_CONFIG, '[DEFAULT]'),\r\n        AngularFireDatabaseModule\r\n      ]\r\n    });\r\n    inject([FirebaseApp, AngularFireDatabase], (app_: FirebaseApp, _db: AngularFireDatabase) => {\r\n      app = app_;\r\n      db = _db;\r\n    })();\r\n  });\r\n\r\n  afterEach(done => {\r\n    app.delete().then(done, done.fail);\r\n  });\r\n\r\n  describe('<constructor>', () => {\r\n\r\n    it('should accept a Firebase db url in the constructor', () => {\r\n      expect(db instanceof AngularFireDatabase).toBe(true);\r\n    });\r\n\r\n  });\r\n\r\n});\r\n\r\ndescribe('FirebaseListFactory', () => {\r\n\r\n  let app: FirebaseApp;\r\n  let db: AngularFireDatabase;\r\n\r\n  beforeEach(() => {\r\n    TestBed.configureTestingModule({\r\n      imports: [\r\n        AngularFireModule.initializeApp(COMMON_CONFIG, '[DEFAULT]'),\r\n        AngularFireDatabaseModule\r\n      ]\r\n    });\r\n    inject([FirebaseApp, AngularFireDatabase], (app_: FirebaseApp, _db: AngularFireDatabase) => {\r\n      app = app_;\r\n      db = _db;\r\n    })();\r\n  });\r\n\r\n\r\n  describe('<constructor>', () => {\r\n\r\n    it('should accept a Firebase db ref in the constructor', () => {\r\n      const list = FirebaseListFactory(app.database().ref(`questions`));\r\n      expect(list instanceof FirebaseListObservable).toBe(true);\r\n    });\r\n\r\n  });\r\n\r\n  describe('query', () => {\r\n\r\n    describe('orderByChild', () => {\r\n      /*\r\n        orderByChild combinations\r\n        ----------------------\r\n        orderByChild(\"\").equalTo()\r\n        orderByChild(\"\").startAt()\r\n        orderByChild(\"\").startAt().endAt();\r\n        orderByChild(\"\").endAt();\r\n      */\r\n      it('equalTo - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            equalTo: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('startAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            startAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('endAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            endAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('should throw an error if limitToLast and limitToFirst are chained', () => {\r\n\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            limitToFirst: 10,\r\n            limitToLast: 100\r\n          }\r\n        });\r\n        expect(observable.subscribe).toThrowError();\r\n      });\r\n\r\n      it('should throw an error if startAt is used with equalTo', () => {\r\n\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            equalTo: 10,\r\n            startAt: 100\r\n          }\r\n        });\r\n        expect(observable.subscribe).toThrowError();\r\n      });\r\n\r\n      it('should throw an error if endAt is used with equalTo', () => {\r\n\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            equalTo: 10,\r\n            endAt: 100\r\n          }\r\n        });\r\n        expect(observable.subscribe).toThrowError();\r\n      });\r\n\r\n      it('should throw an error if startAt and endAt is used with equalTo', () => {\r\n\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            equalTo: 10,\r\n            endAt: 100,\r\n            startAt: 103\r\n          }\r\n        });\r\n        expect(observable.subscribe).toThrowError();\r\n      });\r\n\r\n    });\r\n\r\n    describe('orderByValue', () => {\r\n      /*\r\n        orderByValue combinations\r\n        ----------------------\r\n        orderByValue(\"\").equalTo()\r\n        orderByValue(\"\").startAt()\r\n        orderByValue(\"\").startAt().endAt();\r\n        orderByValue(\"\").endAt();\r\n      */\r\n      it('equalTo - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByValue: true,\r\n            equalTo: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('startAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByValue: true,\r\n            startAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('endAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByValue: true,\r\n            endAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n    });\r\n\r\n    describe('orderByKey', () => {\r\n      /*\r\n        orderByKey combinations\r\n        ----------------------\r\n        orderByKey(\"\").equalTo()\r\n        orderByKey(\"\").startAt()\r\n        orderByKey(\"\").startAt().endAt();\r\n        orderByKey(\"\").endAt();\r\n      */\r\n      it('equalTo - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            equalTo: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('startAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            startAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('endAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            endAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n    });\r\n\r\n    describe('orderByPriority', () => {\r\n      /*\r\n        orderByPriority combinations\r\n        ----------------------\r\n        orderByPriority(\"\").equalTo()\r\n        orderByPriority(\"\").startAt()\r\n        orderByPriority(\"\").startAt().endAt();\r\n        orderByPriority(\"\").endAt();\r\n      */\r\n      it('equalTo - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            equalTo: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('startAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            startAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n\r\n      it('endAt - should re-run a query when the observable value has emitted', (done: any) => {\r\n\r\n        const subject = new Subject();\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByKey: true,\r\n            endAt: subject\r\n          }\r\n        });\r\n\r\n        queryTest(observable, subject, done);\r\n      });\r\n    });\r\n\r\n  });\r\n\r\n  describe('shape', () => {\r\n\r\n    it('should have a a FirebaseListObservable shape when queried', () => {\r\n        const observable = FirebaseListFactory(app.database().ref(questionsPath), {\r\n          query: {\r\n            orderByChild: 'height',\r\n            equalTo: '1'\r\n          }\r\n        });\r\n\r\n        expect(observable.push instanceof Function).toBe(true);\r\n        expect(observable.update instanceof Function).toBe(true);\r\n        expect(observable.remove instanceof Function).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('methods', () => {\r\n\r\n    let toKey: any;\r\n    let val1: any;\r\n    let val2: any;\r\n    let val3: any;\r\n    let questions: FirebaseListObservable<any>;\r\n    let questionsSnapshotted: FirebaseListObservable<any>;\r\n    let ref: any;\r\n    let refSnapshotted: any;\r\n    let subscription: Subscription;\r\n\r\n    beforeEach((done: any) => {\r\n      toKey = (val: any) => val.key;\r\n      val1 = { key: 'key1' };\r\n      val2 = { key: 'key2' };\r\n      val3 = { key: 'key3' };\r\n      app.database().ref().remove(done);\r\n      questions = FirebaseListFactory(app.database().ref(`questions`));\r\n      questionsSnapshotted = FirebaseListFactory(app.database().ref(`questionssnapshot`), { preserveSnapshot: true });\r\n      ref = questions.$ref;\r\n      refSnapshotted = questionsSnapshotted.$ref;\r\n    });\r\n\r\n\r\n    afterEach((done: any) => {\r\n      if (subscription && !subscription.closed) {\r\n        subscription.unsubscribe();\r\n      }\r\n      Promise.all([ref.remove(), refSnapshotted.remove()]).then(done, done.fail);\r\n    });\r\n\r\n\r\n    it('should emit only when the initial data set has been loaded', (done: any) => {\r\n      questions.$ref.ref.set([{ initial1: true }, { initial2: true }, { initial3: true }, { initial4: true }])\r\n        .then(() => toPromise.call(skipAndTake(questions, 1)))\r\n        .then((val: any[]) => {\r\n          expect(val.length).toBe(4);\r\n        })\r\n        .then(() => {\r\n          done();\r\n        }, done.fail);\r\n    });\r\n\r\n\r\n    it('should be resistant to non-asynchronous child_added quirks', (done: any) => {\r\n\r\n      // If push is called (or set or update, too, I guess) immediately after\r\n      // an on or once listener is added, it appears that the on or once\r\n      // child_added listeners are invoked immediately - i.e. not\r\n      // asynchronously - and the list implementation needs to support that.\r\n\r\n      questions.$ref.ref.push({ number: 1 })\r\n        .then(() => {\r\n          let calls: string[] = [];\r\n          questions.$ref.ref.once('child_added', (snap) => calls.push('child_added:' + snap.val().number));\r\n          skipAndTake(questions).subscribe(\r\n            (list: any) => {\r\n              expect(calls).toEqual(['child_added:2', 'pushed']);\r\n              expect(list.map((i: any) => i.number)).toEqual([1, 2]);\r\n              done();\r\n            },\r\n            done.fail\r\n          );\r\n          questions.push({ number: 2 });\r\n          calls.push('pushed');\r\n        })\r\n        .catch(done.fail);\r\n    });\r\n\r\n\r\n    it('should emit a new value when a child moves', (done: any) => {\r\n     let question = skipAndTake(questions, 1, 2)\r\n     subscription = _do.call(question, (data: any) => {\r\n        expect(data.length).toBe(2);\r\n        expect(data[0].push2).toBe(true);\r\n        expect(data[1].push1).toBe(true);\r\n      })\r\n      .subscribe(() => {\r\n        done();\r\n      }, done.fail);\r\n\r\n      let child1 = ref.push({ push1: true }, () => {\r\n        ref.push({ push2: true }, () => {\r\n          child1.setPriority('ZZZZ')\r\n        });\r\n      });\r\n    });\r\n\r\n\r\n    it('should emit unwrapped data by default', (done: any) => {\r\n      ref.remove(() => {\r\n        ref.push({ unwrapped: true }, () => {\r\n          subscription = _do.call(skipAndTake(questions, 1), (data: any) => {\r\n            expect(data.length).toBe(1);\r\n            expect(data[0].unwrapped).toBe(true);\r\n          })\r\n          .subscribe(() => {\r\n            done();\r\n          }, done.fail);\r\n        });\r\n      });\r\n    });\r\n\r\n\r\n    it('should emit snapshots if preserveSnapshot option is true', (done: any) => {\r\n      refSnapshotted.push('hello snapshot!', () => {\r\n        subscription = _do.call(skipAndTake(questionsSnapshotted, 1),(data: any) => {\r\n          expect(data[0].val()).toEqual('hello snapshot!');\r\n        })\r\n        .subscribe(() => {\r\n          done();\r\n        }, done.fail);\r\n      });\r\n    });\r\n\r\n\r\n    it('should re-emit identical instances of unchanged children', (done: any) => {\r\n\r\n      let prev: any;\r\n\r\n      take.call(questions, 2).subscribe(\r\n        (list: any) => {\r\n          if (prev) {\r\n            expect(list[0]).toBe(prev[0]);\r\n            done();\r\n          } else {\r\n            prev = list;\r\n            questions.push({ name: 'bob' });\r\n          }\r\n        },\r\n        done.fail\r\n      );\r\n      questions.push({ name: 'alice' });\r\n    });\r\n\r\n\r\n    it('should re-emit identical instances of unchanged children as snapshots', (done: any) => {\r\n\r\n      let prev: any;\r\n\r\n      take.call(questionsSnapshotted, 2).subscribe(\r\n        (list: any) => {\r\n          if (prev) {\r\n            expect(list[0]).toBe(prev[0]);\r\n            done();\r\n          } else {\r\n            prev = list;\r\n            questionsSnapshotted.push({ name: 'bob' });\r\n          }\r\n        },\r\n        done.fail\r\n      );\r\n      questionsSnapshotted.push({ name: 'alice' });\r\n    });\r\n\r\n\r\n    it('should support null for equalTo queries', (done: any) => {\r\n\r\n      questions.$ref.ref.set({\r\n        val1,\r\n        val2: Object.assign({}, val2, { extra: true }),\r\n        val3: Object.assign({}, val3, { extra: true }),\r\n      })\r\n      .then(() => {\r\n\r\n        let query = FirebaseListFactory(questions.$ref.ref, {\r\n          query: {\r\n            orderByChild: \"extra\",\r\n            equalTo: null\r\n          }\r\n        });\r\n\r\n        take.call(query, 1).subscribe(\r\n          (list: any) => {\r\n            expect(list.length).toEqual(1);\r\n            expect(list[0].$key).toEqual(\"val1\");\r\n            done();\r\n          },\r\n          done.fail\r\n        );\r\n      });\r\n    });\r\n\r\n\r\n    it('should support null for startAt/endAt queries', (done: any) => {\r\n\r\n      questions.$ref.ref.set({\r\n        val1,\r\n        val2: Object.assign({}, val2, { extra: true }),\r\n        val3: Object.assign({}, val3, { extra: true }),\r\n      })\r\n      .then(() => {\r\n\r\n        let query = FirebaseListFactory(questions.$ref.ref, {\r\n          query: {\r\n            orderByChild: \"extra\",\r\n            startAt: null,\r\n            endAt: null\r\n          }\r\n        });\r\n\r\n        take.call(query, 1).subscribe(\r\n          (list: any) => {\r\n            expect(list.length).toEqual(1);\r\n            expect(list[0].$key).toEqual(\"val1\");\r\n            done();\r\n          },\r\n          done.fail\r\n        );\r\n      });\r\n    });\r\n\r\n\r\n    it('should call off on all events when disposed', (done: any) => {\r\n      const questionRef = app.database().ref().child('questions');\r\n      subscription = FirebaseListFactory(questionRef).subscribe(_ => {\r\n        let firebaseSpy = spyOn(questionRef, 'off').and.callThrough();\r\n        expect(firebaseSpy).not.toHaveBeenCalled();\r\n        subscription.unsubscribe();\r\n        expect(firebaseSpy).toHaveBeenCalled();\r\n        done();\r\n      });\r\n    });\r\n\r\n\r\n    describe('onChildAdded', () => {\r\n\r\n      it('should add the child after the prevKey', () => {\r\n        expect(onChildAdded([val1, val2], val3, toKey, 'key1')).toEqual([val1, val3, val2]);\r\n      });\r\n\r\n\r\n      it('should not mutate the input array', () => {\r\n        let inputArr = [val1];\r\n        expect(onChildAdded(inputArr, val2, toKey, 'key1')).not.toEqual(inputArr);\r\n      });\r\n    });\r\n\r\n\r\n    describe('onChildChanged', () => {\r\n\r\n      it('should move the child after the specified prevKey', () => {\r\n        expect(onChildChanged([val1, val2], val1, toKey, 'key2')).toEqual([val2, val1]);\r\n      });\r\n\r\n\r\n      it('should move the child to the beginning if prevKey is null', () => {\r\n        expect(\r\n          onChildChanged([val1, val2, val3], val2, toKey, null!)\r\n        ).toEqual([val2, val1, val3]);\r\n      });\r\n\r\n      it('should not duplicate the first item if it is the one that changed', () => {\r\n        expect(\r\n          onChildChanged([val1, val2, val3], val1, toKey, null!)\r\n        ).not.toEqual([val1, val1, val2, val3]);\r\n      });\r\n\r\n      it('should not mutate the input array', () => {\r\n        let inputArr = [val1, val2];\r\n        expect(onChildChanged(inputArr, val1, toKey, 'key2')).not.toEqual(inputArr);\r\n      });\r\n\r\n\r\n      it('should update the child', () => {\r\n        expect(\r\n          onChildUpdated([val1, val2, val3], { key: 'newkey' }, toKey, 'key1').map(v => v.key)\r\n        ).toEqual(['key1', 'newkey', 'key3']);\r\n      });\r\n    });\r\n\r\n\r\n    describe('onChildRemoved', () => {\r\n\r\n      it('should remove the child', () => {\r\n        expect(\r\n          onChildRemoved([val1, val2, val3], val2, toKey)\r\n        ).toEqual([val1, val3]);\r\n      });\r\n    });\r\n\r\n\r\n    describe('utils.unwrapMapFn', () => {\r\n      let val = { unwrapped: true };\r\n      let snapshot = {\r\n        ref: { key: 'key' },\r\n        val: () => val\r\n      };\r\n\r\n      it('should return an object value with a $key property', () => {\r\n        const unwrapped = utils.unwrapMapFn(snapshot as DataSnapshot);\r\n        expect(unwrapped.$key).toEqual(snapshot.ref.key);\r\n      });\r\n\r\n      it('should return an object value with a $value property if value is scalar', () => {\r\n        const existsFn = () => { return true; }\r\n        const unwrappedValue5 = utils.unwrapMapFn(Object.assign(snapshot, { val: () => 5, exists: existsFn }) as DataSnapshot);\r\n        const unwrappedValueFalse = utils.unwrapMapFn(Object.assign(snapshot, { val: () => false, exists: existsFn }) as DataSnapshot);\r\n        const unwrappedValueLol = utils.unwrapMapFn(Object.assign(snapshot, { val: () => 'lol', exists: existsFn }) as DataSnapshot);\r\n\r\n        expect(unwrappedValue5.$key).toEqual('key');\r\n        expect(unwrappedValue5.$value).toEqual(5);\r\n        expect(unwrappedValue5.$exists()).toEqual(true);\r\n\r\n        expect(unwrappedValueFalse.$key).toEqual('key');\r\n        expect(unwrappedValueFalse.$value).toEqual(false);\r\n        expect(unwrappedValueFalse.$exists()).toEqual(true);\r\n\r\n        expect(unwrappedValueLol.$key).toEqual('key');\r\n        expect(unwrappedValueLol.$value).toEqual('lol');\r\n        expect(unwrappedValueLol.$exists()).toEqual(true);\r\n      });\r\n    });\r\n\r\n    it('should emit values in the observable creation zone', (done: any) => {\r\n      Zone.current.fork({\r\n        name: 'newZone'\r\n      })\r\n      .run(() => {\r\n        // Creating a new observable so that the current zone is captured.\r\n        subscription = FirebaseListFactory(app.database().ref(`questions`))\r\n          .filter(d => d\r\n            .map((v: any) => v.$value)\r\n            .indexOf('in-the-zone') > -1)\r\n          .subscribe(data => {\r\n            expect(Zone.current.name).toBe('newZone');\r\n            done();\r\n          });\r\n      });\r\n\r\n      ref.remove(() => {\r\n        ref.push('in-the-zone');\r\n      });\r\n    });\r\n\r\n    describe('Removing and replacing a child key', () => {\r\n      const firstKey = 'index1';\r\n      const middleKey = 'index2';\r\n      const lastKey = 'index3';\r\n      const initialData = {\r\n        [firstKey]: true,\r\n        [middleKey]: true,\r\n        [lastKey]: true,\r\n      };\r\n      let keyToRemove: string;\r\n\r\n      afterEach((done: any) => {\r\n        subscription = questions\r\n          .skip(2)\r\n          .take(1)\r\n          .subscribe((items: any[]) => {\r\n            expect(items.length).toBe(3);\r\n            done();\r\n          }, done.fail);\r\n        questions.$ref.ref.set(initialData)\r\n          .then(() => ref.child(keyToRemove).remove())\r\n          .then(() => ref.child(keyToRemove).set(true));\r\n      });\r\n\r\n      it('should work with the first item in the list', () => {\r\n        keyToRemove = firstKey;\r\n      });\r\n\r\n      it('should work with the middle item in the list', () => {\r\n        keyToRemove = middleKey;\r\n      });\r\n\r\n      it('should work with the last item in the list', () => {\r\n        keyToRemove = lastKey;\r\n      });\r\n    });\r\n\r\n    describe('startAt(value, key)', () => {\r\n\r\n      it('should support the optional key parameter to startAt', (done) => {\r\n\r\n        questions.$ref.ref.set({\r\n          val1: Object.assign({}, val1, { data: 0 }),\r\n          val2: Object.assign({}, val2, { data: 0 }),\r\n          val3: Object.assign({}, val3, { data: 0 })\r\n        })\r\n        .then(() => {\r\n\r\n          let query1 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              startAt: { value: 0 }\r\n            }\r\n          });\r\n          let promise1 = toPromise.call(take.call(query1, 1));\r\n\r\n          let query2 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              startAt: { value: 0, key: 'val2' }\r\n            }\r\n          });\r\n          let promise2 = toPromise.call(take.call(query2, 1));\r\n\r\n          Promise.all([promise1, promise2]).then(([list1, list2]) => {\r\n            expect(list1.map((i: any) => i.$key)).toEqual(['val1', 'val2', 'val3']);\r\n            expect(list2.map((i: any) => i.$key)).toEqual(['val2', 'val3']);\r\n            done();\r\n          });\r\n        })\r\n        .catch(done.fail);\r\n      });\r\n\r\n    });\r\n\r\n    describe('equalTo(value, key)', () => {\r\n\r\n      it('should support the optional key parameter to equalTo', (done) => {\r\n\r\n        questions.$ref.ref.set({\r\n          val1: Object.assign({}, val1, { data: 0 }),\r\n          val2: Object.assign({}, val2, { data: 0 }),\r\n          val3: Object.assign({}, val3, { data: 0 })\r\n        })\r\n        .then(() => {\r\n\r\n          let query1 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              equalTo: { value: 0 }\r\n            }\r\n          });\r\n          let promise1 = toPromise.call(take.call(query1, 1));\r\n\r\n          let query2 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              equalTo: { value: 0, key: 'val2' }\r\n            }\r\n          });\r\n          let promise2 = toPromise.call(take.call(query2, 1));\r\n\r\n          Promise.all([promise1, promise2]).then(([list1, list2]) => {\r\n            expect(list1.map((i: any) => i.$key)).toEqual(['val1', 'val2', 'val3']);\r\n            expect(list2.map((i: any) => i.$key)).toEqual(['val2']);\r\n            done();\r\n          });\r\n        })\r\n        .catch(done.fail);\r\n      });\r\n\r\n    });\r\n\r\n    describe('endAt(value, key)', () => {\r\n\r\n      it('should support the optional key parameter to endAt', (done) => {\r\n\r\n        questions.$ref.ref.set({\r\n          val1: Object.assign({}, val1, { data: 0 }),\r\n          val2: Object.assign({}, val2, { data: 0 }),\r\n          val3: Object.assign({}, val3, { data: 0 })\r\n        })\r\n        .then(() => {\r\n\r\n          let query1 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              endAt: { value: 0 }\r\n            }\r\n          });\r\n          let promise1 = toPromise.call(take.call(query1, 1));\r\n\r\n          let query2 = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'data',\r\n              endAt: { value: 0, key: 'val2' }\r\n            }\r\n          });\r\n          let promise2 = toPromise.call(take.call(query2, 1));\r\n\r\n          Promise.all([promise1, promise2]).then(([list1, list2]) => {\r\n            expect(list1.map((i: any) => i.$key)).toEqual(['val1', 'val2', 'val3']);\r\n            expect(list2.map((i: any) => i.$key)).toEqual(['val1', 'val2']);\r\n            done();\r\n          });\r\n        })\r\n        .catch(done.fail);\r\n      });\r\n\r\n    });\r\n\r\n    describe('observable queries (issue #830)', () => {\r\n\r\n      it('should not emit the results of previous queries', (done) => {\r\n\r\n        questions.$ref.ref.set({\r\n          key1: { even: false, value: 1 },\r\n          key2: { even: true, value: 2 }\r\n        })\r\n        .then(() => {\r\n\r\n          let subject = new Subject<boolean>();\r\n          let query = FirebaseListFactory(app.database().ref(`questions`), {\r\n            query: {\r\n              orderByChild: 'even',\r\n              equalTo: subject\r\n            }\r\n          });\r\n\r\n          query = map.call(query, (list: any, index: any) => {\r\n            switch (index) {\r\n            case 0:\r\n              subject.next(true);\r\n              break;\r\n            case 1:\r\n              questions.$ref.ref.update({\r\n                key3: { even: false, value: 3 },\r\n                key4: { even: true, value: 4 }\r\n              });\r\n              break;\r\n            default:\r\n              break;\r\n            }\r\n            return list;\r\n          });\r\n          query = take.call(query, 3);\r\n          query = toArray.call(query);\r\n\r\n          toPromise.call(query).then((emits: any) => {\r\n            expect(emits.map((e: any) => e.map((i: any) => i.$key))).toEqual([\r\n              ['key1'],\r\n              ['key2'],\r\n              ['key2', 'key4']\r\n            ]);\r\n            done();\r\n          });\r\n\r\n          subject.next(false);\r\n        })\r\n        .catch(done.fail);\r\n      });\r\n\r\n    });\r\n\r\n  });\r\n});\r\n\r\nfunction skipAndTake<T>(obs: Observable<T>, takeCount: number = 1, skipCount: number = 0) {\r\n  return take.call(skip.call(obs, skipCount), takeCount);\r\n}\r\n"]}